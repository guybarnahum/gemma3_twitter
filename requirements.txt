# --- Core ABI pins (put first so wheels resolve against them) ---
numpy<2
pyarrow>=14,<17
protobuf<5

# --- HF stack ---
torch>=2.2,<2.4
transformers>=4.46.0
huggingface_hub>=0.24.0
datasets>=2.18,<3.0
accelerate>=0.31,<0.35
peft>=0.11,<0.13
trl>=0.9.6,<0.10

# --- Tokenization / utils ---
sentencepiece
safetensors>=0.4.3
einops>=0.7.0
tqdm>=4.66.0

# --- Optional 4-bit (Linux/NVIDIA only; skip on macOS) ---
bitsandbytes>=0.43.0 ; platform_system != "Darwin"

