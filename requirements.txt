# --- Core ABI pins (put first so wheels resolve against them) ---
numpy<2
pyarrow>=14,<17
protobuf<5

# --- HF stack (Gemma-3 needs Transformers â‰¥ 4.53) ---
torch>=2.2,<2.4
transformers>=4.53.0,<5
huggingface_hub>=0.24.0
datasets>=2.18,<3.0
accelerate>=0.33.0
peft>=0.13.0
trl>=0.9.6

# --- Tokenization / utils ---
sentencepiece
safetensors>=0.4.3
einops>=0.7.0
tqdm>=4.66.0

# --- Optional 4-bit (Linux/NVIDIA only) ---
bitsandbytes==0.43.1 ; platform_system != "Darwin" and platform_machine == "x86_64"
